# [25-W SQL 스터디] 5주차 공부

## 1. [카테고리 별 도서 판매량 집계하기](https://school.programmers.co.kr/learn/courses/30/lessons/144855)
공부한 날짜: 2025년 2월 7일

### 작성한 SQL 쿼리
```SQL
SELECT
    B.CATEGORY,
    SUM(BS.SALES) AS TOTAL_SALES
FROM BOOK AS B
JOIN BOOK_SALES AS BS ON B.BOOK_ID = BS.BOOK_ID
WHERE BS.SALES_DATE LIKE '2022-01-%'
GROUP BY B.CATEGORY
ORDER BY B.CATEGORY;
```

### 함수 공부
```SQL
HAVING BS.SALES_DATE LIKE '2022-01-%'
이런 식으로 HAVING절을 쓸 수 없는 이유
-> HAVING 절이 GROUP BY 후의 SUM(BS.SALES)와 같은 집계 결과를 필터링할 때 사용해야 하므로
이 문제에서는 사용할 수 없음
```


## 2.[오랜 기간 보호한 동물(2)](https://school.programmers.co.kr/learn/courses/30/lessons/59411)
공부한 날짜: 2025년 2월 7일

### 작성한 SQL 쿼리
```SQL
SELECT I.ANIMAL_ID, I.NAME
FROM ANIMAL_INS AS I
JOIN ANIMAL_OUTS AS O ON I.ANIMAL_ID = O.ANIMAL_ID
ORDER BY DATEDIFF(O.DATETIME, I.DATETIME) DESC
LIMIT 2;
```


## 3. [대여 기록이 존재하는 자동차 리스트 구하기](https://school.programmers.co.kr/learn/courses/30/lessons/157341)
공부한 날짜: 2025년 2월 7일

### 작성한 SQL 쿼리
```SQL
SELECT DISTINCT A.CAR_ID
FROM CAR_RENTAL_COMPANY_CAR AS A
JOIN CAR_RENTAL_COMPANY_RENTAL_HISTORY AS B ON A.CAR_ID = B.CAR_ID
WHERE (A.CAR_TYPE = '세단') AND (MONTH(B.START_DATE) = 10)
ORDER BY A.CAR_ID DESC;
```


## 4. [즐겨찾기가 가장 많은 식당 정보 출력하기⭐](https://school.programmers.co.kr/learn/courses/30/lessons/131123)
공부한 날짜: 2025년 2월 7일

### 작성한 SQL 쿼리
```SQL
SELECT
    FOOD_TYPE,
    REST_ID,
    REST_NAME,
    FAVORITES
FROM REST_INFO
WHERE FAVORITES IN (SELECT MAX(FAVORITES)
                   FROM REST_INFO
                   GROUP BY FOOD_TYPE)
GROUP BY FOOD_TYPE
ORDER BY FOOD_TYPE DESC;
```

### 함수 공부
이렇게 쿼리를 작성하면 오답이라고 나온다. 왜 그럴까?

참고로 실행 결과는 완전히 동일하게 나온다...
```SQL
SELECT
    FOOD_TYPE,
    REST_ID,
    REST_NAME,
    MAX(FAVORITES) AS FAVORITES
FROM REST_INFO
GROUP BY FOOD_TYPE
ORDER BY FOOD_TYPE DESC;
```
![](https://github.com/bird-one-00/25-W_SQL_study/blob/main/img/%EC%8A%A4%ED%81%AC%EB%A6%B0%EC%83%B7%202025-02-07%20135604.png)

[왜 이렇게 작성하면 안 되나요?](https://school.programmers.co.kr/questions/38854)

-> GROUP BY가 MAX함수까지 커버하지 못한다

-> 결국 서브 쿼리를 사용해야 한다(나는 이 문제가 싫다...ㅠㅠ)

![](https://github.com/bird-one-00/25-W_SQL_study/blob/main/img/%EC%8A%A4%ED%81%AC%EB%A6%B0%EC%83%B7%202025-02-07%20140711.png)


## 5. [없어진 기록 찾기](https://school.programmers.co.kr/learn/courses/30/lessons/59042)
공부한 날짜: 2025년 2월 7일

### 작성한 SQL 쿼리
```SQL
SELECT O.ANIMAL_ID, O.NAME
FROM ANIMAL_OUTS AS O
LEFT JOIN ANIMAL_INS AS I ON O.ANIMAL_ID = I.ANIMAL_ID
WHERE I.ANIMAL_ID IS NULL
ORDER BY O.ANIMAL_ID;
```

### 함수 공부⭐
1. OUTER JOIN을 SQL에서 쓸 때,
정식 명칭은 FULL OUTER JOIN이다~ 그냥 OUTER JOIN이라고 쓰면 에러난다~

2. [LEFT JOIN과 INNER JOIN의 성능 차이](https://velog.io/@profile_exe/SQL-LEFT-JOIN-INNER-JOIN-%EC%B0%A8%EC%9D%B4)
두 테이블에서 `JOIN`을 위한 **기준 열이 서로 값을 가지고 있는 경우** 조회에서 **누락되는 행은 존재하지 않는다.**
그렇다면 `LEFT JOIN`과 `INNER JOIN`은 같은 조회 결과를 보인다. 이때, **`INNER JOIN`이 상대적으로 성능이 좋다**고 한다.


## 6. [대장균의 크기에 따라 분류하기 1](https://school.programmers.co.kr/learn/courses/30/lessons/299307)
공부한 날짜: 2025년 2월 7일

### 작성한 SQL 쿼리
```SQL
SELECT
    ID,
    CASE
        WHEN SIZE_OF_COLONY <= 100 THEN 'LOW'
        WHEN SIZE_OF_COLONY <= 1000 THEN 'MEDIUM'
        ELSE 'HIGH'
    END AS SIZE
FROM ECOLI_DATA
ORDER BY ID;
```